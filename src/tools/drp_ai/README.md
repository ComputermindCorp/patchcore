# for DRP-AI
This is the procedure for generating the memory bank file used in the PatchCore sample application for Renesas DRP-AI(RZ-V2H).

Renesas社製DRP-AI用のPatchCoreサンプルアプリで使用するmemorybankファイルを生成する手順です。

## setup
download onnx file.
```bash
cd models/patch_core/backborn/model
wget https://github.com/ComputermindCorp/assets/releases/download/v1.0.0/resnet18_features.onnx
wget https://github.com/ComputermindCorp/assets/releases/download/v1.0.0/resnet18_features_quantization.onnx
```

## create memorybank
RZ/V2H uses quantized weights. Therefore, when creating memory banks in scripts in this repository, quantized CNN models are used.

Please refer to [resnet18_quantization_onnx_wood.yaml](../../cfg/train/resnet18_quantization_onnx_wood.yaml) for the configuration yaml during training.

RZ/V2Hは量子化された重みを使用します。そのため、このリポジトリのスクリプトでメモリバンクを作成する際には、量子化されたCNNモデルを使用します。

学習の設定yamlは[resnet18_quantization_onnx_wood.yaml](../../cfg/train/resnet18_quantization_onnx_wood.yaml)を参考にしてください。

```cfg/train/resnet18_quantization_onnx_wood.yaml
backborn_id: resnet18_quantization_onnx
```

## convert memorybank file
Convert the memory bank files generated by the scripts in this repository to work with the sample programs for DRP-AI.

DRP-AI用サンプルプログラムで動作させるために、本リポジトリのスクリプトで生成されたメモリバンクファイルを変換します。

```bash
convert_memorybank_torch2binary.py input_path output_path
```

### ex
```bash
convert_memorybank_torch2binary.py data/weights/resnet18_quantization_onnx_size224_param_0.1_9.pth test.bin
```
